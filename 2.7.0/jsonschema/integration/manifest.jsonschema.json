{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.elastic.dev/package-spec/2.7.0/integration/manifest.jsonschema.json",
  "type": "object",
  "required": [
    "format_version",
    "name",
    "title",
    "description",
    "version",
    "type",
    "owner"
  ],
  "properties": {
    "categories": {
      "$ref": "#/definitions/categories"
    },
    "conditions": {
      "$ref": "#/definitions/conditions"
    },
    "description": {
      "$ref": "#/definitions/description"
    },
    "elasticsearch": {
      "description": "Elasticsearch requirements",
      "type": "object",
      "properties": {
        "privileges": {
          "description": "Elasticsearch privilege requirements",
          "type": "object",
          "properties": {
            "cluster": {
              "description": "Elasticsearch cluster privilege requirements",
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "format_version": {
      "description": "The version of the package specification format used by this package.",
      "$ref": "#/definitions/version"
    },
    "icons": {
      "$ref": "#/definitions/icons"
    },
    "name": {
      "description": "The name of the package.",
      "examples": [
        "apache"
      ],
      "type": "string",
      "pattern": "^[a-z0-9_]+$"
    },
    "owner": {
      "$ref": "#/definitions/owner"
    },
    "policy_templates": {
      "description": "List of policy templates offered by this package.",
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "name",
          "title",
          "description"
        ],
        "properties": {
          "categories": {
            "$ref": "#/definitions/categories"
          },
          "data_streams": {
            "description": "List of data streams compatible with the policy template.",
            "type": "array",
            "items": {
              "description": "Data stream name",
              "examples": [
                "ec2_logs",
                "spamfirewall",
                "access"
              ],
              "type": "string",
              "format": "data-stream-name"
            }
          },
          "description": {
            "description": "Longer description of policy template.",
            "examples": [
              "Collect logs and metrics from Apache instances"
            ],
            "type": "string"
          },
          "icons": {
            "$ref": "#/definitions/icons"
          },
          "inputs": {
            "description": "List of inputs supported by policy template.",
            "type": "array",
            "items": {
              "type": "object",
              "required": [
                "type",
                "title",
                "description"
              ],
              "properties": {
                "description": {
                  "description": "Longer description of input.",
                  "examples": [
                    "Collecting Apache access and error logs"
                  ],
                  "type": "string"
                },
                "input_group": {
                  "description": "Name of the input group",
                  "type": "string",
                  "enum": [
                    "logs",
                    "metrics"
                  ]
                },
                "multi": {
                  "description": "Can input be defined multiple times",
                  "default": false,
                  "type": "boolean"
                },
                "template_path": {
                  "description": "Path of the config template for the input.",
                  "examples": [
                    "./agent/input/template.yml.hbs"
                  ],
                  "type": "string"
                },
                "title": {
                  "description": "Title of input.",
                  "examples": [
                    "Collect logs from Apache instances"
                  ],
                  "type": "string"
                },
                "type": {
                  "description": "Type of input.",
                  "type": "string"
                },
                "vars": {
                  "$ref": "./data_stream/manifest.jsonschema.json#/definitions/vars"
                }
              },
              "additionalProperties": false
            }
          },
          "multiple": {
            "type": "boolean"
          },
          "name": {
            "description": "Name of policy template.",
            "examples": [
              "apache"
            ],
            "type": "string"
          },
          "screenshots": {
            "$ref": "#/definitions/screenshots"
          },
          "title": {
            "description": "Title of policy template.",
            "examples": [
              "Apache logs and metrics"
            ],
            "type": "string"
          },
          "vars": {
            "$ref": "./data_stream/manifest.jsonschema.json#/definitions/vars"
          }
        },
        "additionalProperties": false
      }
    },
    "screenshots": {
      "$ref": "#/definitions/screenshots"
    },
    "source": {
      "$ref": "#/definitions/source"
    },
    "title": {
      "$ref": "#/definitions/title"
    },
    "type": {
      "description": "The type of package.",
      "examples": [
        "integration"
      ],
      "type": "string",
      "enum": [
        "integration"
      ]
    },
    "vars": {
      "$ref": "./data_stream/manifest.jsonschema.json#/definitions/vars"
    },
    "version": {
      "description": "The version of the package.",
      "$ref": "#/definitions/version"
    }
  },
  "additionalProperties": false,
  "definitions": {
    "categories": {
      "description": "Categories to which this package belongs.",
      "type": "array",
      "items": {
        "examples": [
          "web"
        ],
        "type": "string",
        "enum": [
          "analytics_engine",
          "application_observability",
          "app_search",
          "auditd",
          "authentication",
          "aws",
          "azure",
          "big_data",
          "cdn_security",
          "cloud",
          "config_management",
          "connector",
          "connector_client",
          "connector_package",
          "containers",
          "content_source",
          "crawler",
          "credential_management",
          "crm",
          "custom",
          "custom_logs",
          "database_security",
          "datastore",
          "dns_security",
          "edr_xdr",
          "elasticsearch_sdk",
          "elastic_stack",
          "email_security",
          "enterprise_search",
          "firewall_security",
          "google_cloud",
          "iam",
          "ids_ips",
          "infrastructure",
          "java_observability",
          "kubernetes",
          "language_client",
          "languages",
          "load_balancer",
          "message_queue",
          "monitoring",
          "native_search",
          "network",
          "network_security",
          "notification",
          "observability",
          "os_system",
          "process_manager",
          "productivity",
          "productivity_security",
          "proxy_security",
          "sdk_search",
          "security",
          "stream_processing",
          "support",
          "threat_intel",
          "ticketing",
          "version_control",
          "virtualization",
          "vpn_security",
          "vulnerability_management",
          "web",
          "web_application_firewall",
          "websphere",
          "workplace_search"
        ]
      }
    },
    "conditions": {
      "description": "Conditions under which this package can be installed.",
      "type": "object",
      "properties": {
        "elastic": {
          "description": "Elastic conditions",
          "type": "object",
          "properties": {
            "subscription": {
              "description": "The subscription required for this package.",
              "examples": [
                "basic"
              ],
              "default": "basic",
              "type": "string",
              "enum": [
                "basic",
                "gold",
                "platinum",
                "enterprise"
              ]
            }
          },
          "additionalProperties": false
        },
        "kibana": {
          "description": "Kibana conditions",
          "type": "object",
          "properties": {
            "version": {
              "description": "Kibana versions compatible with this package.",
              "examples": [
                ">=7.9.0"
              ],
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "description": {
      "description": "A longer description of the package. It should describe, at least all the kinds of data that is collected and with what collectors, following the structure \"Collect X from Y with X\".\n",
      "examples": [
        "Collect logs and metrics from Apache HTTP Servers with Elastic Agent.",
        "Collect logs and metrics from Amazon Web Services with Elastic Agent."
      ],
      "type": "string"
    },
    "icons": {
      "description": "List of icons for by this package.",
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "src"
        ],
        "properties": {
          "dark_mode": {
            "description": "Is this icon to be shown in dark mode?",
            "default": false,
            "type": "boolean"
          },
          "size": {
            "description": "Size of the icon.",
            "examples": [
              "32x32"
            ],
            "type": "string"
          },
          "src": {
            "description": "Relative path to the icon's image file.",
            "examples": [
              "/img/logo_apache.svg"
            ],
            "type": "string",
            "format": "relative-path"
          },
          "title": {
            "description": "Title of icon.",
            "examples": [
              "Apache Logo"
            ],
            "type": "string"
          },
          "type": {
            "description": "MIME type of the icon image file.",
            "examples": [
              "image/svg+xml"
            ],
            "type": "string"
          }
        },
        "additionalProperties": false
      }
    },
    "owner": {
      "type": "object",
      "required": [
        "github"
      ],
      "properties": {
        "github": {
          "description": "GitHub repository name of package maintainer.",
          "type": "string",
          "pattern": "^(([a-zA-Z0-9-]+)|([a-zA-Z0-9-]+\\/[a-zA-Z0-9-]+))$"
        }
      },
      "additionalProperties": false
    },
    "screenshots": {
      "description": "List of screenshots of Kibana assets created by this package.",
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "src",
          "title"
        ],
        "properties": {
          "size": {
            "description": "Size of the screenshot.",
            "examples": [
              "1215x1199"
            ],
            "type": "string"
          },
          "src": {
            "description": "Relative path to the screenshot's image file.",
            "examples": [
              "/img/apache_httpd_server_status.png"
            ],
            "type": "string",
            "format": "relative-path"
          },
          "title": {
            "description": "Title of screenshot.",
            "examples": [
              "Apache HTTPD Server Status"
            ],
            "type": "string"
          },
          "type": {
            "description": "MIME type of the screenshot image file.",
            "examples": [
              "image/png"
            ],
            "type": "string"
          }
        },
        "additionalProperties": false
      }
    },
    "source": {
      "description": "Information about the source of the package.",
      "type": "object",
      "properties": {
        "license": {
          "description": "Identifier of the license of the package, as specified in https://spdx.org/licenses/.",
          "examples": [
            "Elastic-2.0"
          ],
          "type": "string",
          "enum": [
            "Apache-2.0",
            "Elastic-2.0"
          ]
        }
      },
      "additionalProperties": false
    },
    "title": {
      "description": "Title of the package. It should be the usual title given to the product, service or kind of source being managed by this package.\n",
      "examples": [
        "Apache HTTP Server",
        "MySQL",
        "AWS"
      ],
      "type": "string"
    },
    "version": {
      "description": "Version of the package, following semantic versioning. It can include pre-release labels.",
      "examples": [
        "1.0.0",
        "1.0.0-beta1",
        "1.0.0-SNAPSHOT",
        "1.0.0-next"
      ],
      "type": "string",
      "pattern": "^([0-9]+)\\.([0-9]+)\\.([0-9]+)(?:-([0-9A-Za-z-]+(?:\\.[0-9A-Za-z-]+)*))?(?:\\+[0-9A-Za-z-]+)?$"
    }
  }
}
