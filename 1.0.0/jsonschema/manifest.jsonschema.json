{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.elastic.dev/package-spec/1.0.0/manifest.jsonschema.json",
  "type": "object",
  "required": [
    "format_version",
    "name",
    "title",
    "description",
    "version",
    "release",
    "owner"
  ],
  "properties": {
    "title": {
      "description": "The title of the package.",
      "examples": [
        "Apache"
      ],
      "type": "string"
    },
    "description": {
      "description": "A longer description of the package.",
      "examples": [
        "Apache Integration"
      ],
      "type": "string"
    },
    "type": {
      "description": "The type of package.",
      "examples": [
        "integration"
      ],
      "type": "string",
      "enum": [
        "integration"
      ]
    },
    "format_version": {
      "description": "The version of the package specification format used by this package.",
      "$ref": "#/definitions/version"
    },
    "categories": {
      "$ref": "#/definitions/categories"
    },
    "conditions": {
      "description": "Conditions under which this package can be installed.",
      "type": "object",
      "properties": {
        "kibana": {
          "description": "Kibana conditions",
          "type": "object",
          "properties": {
            "version": {
              "description": "Kibana versions compatible with this package.",
              "examples": [
                ">=7.9.0"
              ],
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "icons": {
      "$ref": "#/definitions/icons"
    },
    "license": {
      "description": "The license under which the package is being released.",
      "examples": [
        "basic"
      ],
      "default": "basic",
      "type": "string",
      "enum": [
        "basic"
      ]
    },
    "name": {
      "description": "The name of the package.",
      "examples": [
        "apache"
      ],
      "type": "string",
      "pattern": "^[a-z0-9_]+$"
    },
    "owner": {
      "type": "object",
      "required": [
        "github"
      ],
      "properties": {
        "github": {
          "description": "GitHub repository name of package maintainer.",
          "type": "string",
          "pattern": "^(([a-zA-Z0-9-]+)|([a-zA-Z0-9-]+\\/[a-zA-Z0-9-]+))$"
        }
      },
      "additionalProperties": false
    },
    "policy_templates": {
      "description": "List of policy templates offered by this package.",
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "name",
          "title",
          "description"
        ],
        "properties": {
          "title": {
            "description": "Title of policy template.",
            "examples": [
              "Apache logs and metrics"
            ],
            "type": "string"
          },
          "description": {
            "description": "Longer description of policy template.",
            "examples": [
              "Collect logs and metrics from Apache instances"
            ],
            "type": "string"
          },
          "categories": {
            "$ref": "#/definitions/categories"
          },
          "data_streams": {
            "description": "List of data streams compatible with the policy template.",
            "type": "array",
            "items": {
              "description": "Data stream name",
              "examples": [
                "ec2_logs",
                "spamfirewall",
                "access"
              ],
              "type": "string",
              "format": "data-stream-name"
            }
          },
          "icons": {
            "$ref": "#/definitions/icons"
          },
          "inputs": {
            "description": "List of inputs supported by policy template.",
            "type": "array",
            "items": {
              "type": "object",
              "required": [
                "type",
                "title",
                "description"
              ],
              "properties": {
                "title": {
                  "description": "Title of input.",
                  "examples": [
                    "Collect logs from Apache instances"
                  ],
                  "type": "string"
                },
                "description": {
                  "description": "Longer description of input.",
                  "examples": [
                    "Collecting Apache access and error logs"
                  ],
                  "type": "string"
                },
                "type": {
                  "description": "Type of input.",
                  "type": "string"
                },
                "input_group": {
                  "description": "Name of the input group",
                  "type": "string",
                  "enum": [
                    "logs",
                    "metrics"
                  ]
                },
                "multi": {
                  "description": "Can input be defined multiple times",
                  "default": false,
                  "type": "boolean"
                },
                "template_path": {
                  "description": "Path of the config template for the input.",
                  "examples": [
                    "./agent/input/template.yml.hbs"
                  ],
                  "type": "string"
                },
                "vars": {
                  "$ref": "./data_stream/manifest.jsonschema.json#/definitions/vars"
                }
              },
              "additionalProperties": false
            }
          },
          "multiple": {
            "type": "boolean"
          },
          "name": {
            "description": "Name of policy template.",
            "examples": [
              "apache"
            ],
            "type": "string"
          },
          "screenshots": {
            "$ref": "#/definitions/screenshots"
          },
          "vars": {
            "$ref": "./data_stream/manifest.jsonschema.json#/definitions/vars"
          }
        },
        "additionalProperties": false
      }
    },
    "release": {
      "description": "The stability of the package.",
      "examples": [
        "experimental"
      ],
      "type": "string",
      "enum": [
        "experimental",
        "beta",
        "ga"
      ]
    },
    "screenshots": {
      "$ref": "#/definitions/screenshots"
    },
    "vars": {
      "$ref": "./data_stream/manifest.jsonschema.json#/definitions/vars"
    },
    "version": {
      "description": "The version of the package.",
      "$ref": "#/definitions/version"
    }
  },
  "additionalProperties": false,
  "definitions": {
    "categories": {
      "description": "Categories to which this package belongs.",
      "type": "array",
      "items": {
        "examples": [
          "web"
        ],
        "type": "string",
        "enum": [
          "aws",
          "azure",
          "cloud",
          "config_management",
          "containers",
          "crm",
          "custom",
          "datastore",
          "elastic_stack",
          "google_cloud",
          "kubernetes",
          "languages",
          "message_queue",
          "monitoring",
          "network",
          "notification",
          "os_system",
          "productivity",
          "security",
          "support",
          "ticketing",
          "version_control",
          "web"
        ]
      }
    },
    "icons": {
      "description": "List of icons for by this package.",
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "src"
        ],
        "properties": {
          "title": {
            "description": "Title of icon.",
            "examples": [
              "Apache Logo"
            ],
            "type": "string"
          },
          "type": {
            "description": "MIME type of the icon image file.",
            "examples": [
              "image/svg+xml"
            ],
            "type": "string"
          },
          "size": {
            "description": "Size of the icon.",
            "examples": [
              "32x32"
            ],
            "type": "string"
          },
          "src": {
            "description": "Relative path to the icon's image file.",
            "examples": [
              "/img/logo_apache.svg"
            ],
            "type": "string",
            "format": "relative-path"
          }
        },
        "additionalProperties": false
      }
    },
    "screenshots": {
      "description": "List of screenshots of Kibana assets created by this package.",
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "src",
          "title"
        ],
        "properties": {
          "title": {
            "description": "Title of screenshot.",
            "examples": [
              "Apache HTTPD Server Status"
            ],
            "type": "string"
          },
          "type": {
            "description": "MIME type of the screenshot image file.",
            "examples": [
              "image/png"
            ],
            "type": "string"
          },
          "size": {
            "description": "Size of the screenshot.",
            "examples": [
              "1215x1199"
            ],
            "type": "string"
          },
          "src": {
            "description": "Relative path to the screenshot's image file.",
            "examples": [
              "/img/apache_httpd_server_status.png"
            ],
            "type": "string",
            "format": "relative-path"
          }
        },
        "additionalProperties": false
      }
    },
    "version": {
      "examples": [
        "1.0.0",
        "1.0.0-SNAPSHOT",
        "1.0.0-dev.1"
      ],
      "type": "string",
      "pattern": "^([0-9]+)\\.([0-9]+)\\.([0-9]+)(?:-([0-9A-Za-z-]+(?:\\.[0-9A-Za-z-]+)*))?(?:\\+[0-9A-Za-z-]+)?$"
    }
  }
}
